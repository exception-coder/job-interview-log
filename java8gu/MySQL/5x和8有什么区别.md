## 1）10 行极简速记版（小红书爆款风）

✔ 8.0 = 全面重写的“性能怪兽”，读写直接翻倍
🔥 查询缓存直接移除，避免高并发毒瘤
📌 窗口函数、CTE 上线，SQL 表达力质变
🚀 隐藏索引助力调优，敢删敢测更稳
🧠 JSON/文档存储增强，MySQL 也能半 NoSQL
✨ 降序索引 + 新优化器，排序性能直观提升
📈 DDL 原子化 + Crash-Safe，可靠性大升级
🔍 utf8mb4 默认字符集，彻底解决 Emoji/宽字符问题
⚠️ 5.x 的很多旧特性已弃用，迁移要特别注意
➤ 8.0 = 性能、语法、可靠性、安全性全方位强化

## 2）折叠式知识卡片版

<details>
<summary>定义</summary>

MySQL 5.x 与 8.0 的差异涵盖性能架构、语法能力、存储能力、可靠性与高可用增强。8.0 属于“架构级升级”，非小修小补。

</details>

<details>
<summary>原理</summary>

* **性能增强**：优化器重写、redo/undo 管理改进、IO 密集优化，整体吞吐显著提升。
* **查询缓存移除**：避免高并发下缓存无效与锁争用，改走实际执行计划优化路径。
* **NoSQL 文档模式增强**：JSON 处理能力提升，实现 ACID 级文档存储。
* **隐藏索引**：允许在不删除索引的前提下禁用索引供调优试验。
* **DDL 原子化**：InnoDB 元数据写入至事务字典，实现 DDL 的事务一致性。
* **安全增强**：更强认证协议、OpenSSL 改进、角色系统与密码策略更新。

</details>

<details>
<summary>关键点</summary>

* 8.0 整体速度比 5.7 快约 2 倍。
* 支持窗口函数、CTE，大幅提升查询表达能力。
* 隐藏索引用于可靠的调优与索引验证。
* 支持降序索引，优化排序场景性能。
* 强化 JSON 存储与函数体系，更接近半结构化数据库。
* 默认字符集改为 utf8mb4，国际化更完善。
* 事务性 DDL、crash-safe 元数据，大幅提升可靠性。
* InnoDB 集群增强 HA，提供原生高可用方案。

</details>

<details>
<summary>扩展知识</summary>

文档未提但可补充：

* 8.0 使用“数据字典统一存储结构”，替代 5.x 的 .frm 等外部文件，解决一致性问题。
* 优化器引入更智能的成本模型，减少错误执行计划概率。
* 新版本日志子系统提升崩溃恢复速度。

</details>

## 3）面试官追问（Q&A）

问：为什么 MySQL 8.0 删除查询缓存？
答：高并发下会频繁失效并产生锁竞争，反而降低性能，不如优化器和二级缓存体系更高效。

问：窗口函数能解决哪些 5.x 无法处理的场景？
答：排名、滑动窗口、累计计算等无需额外子查询或手工统计，SQL 可读性和性能显著提升。

问：隐藏索引的应用场景是什么？
答：用于判断某索引是否真正有用，隐藏后观察性能变化再决定是否删除。

问：为什么 utf8mb4 成为默认字符集？
答：解决 UTF-8 不完整、Emoji 乱码等问题，同时在国际化场景中更规范。

问：8.0 性能提升来自哪里？
答：优化器重写、并行查询增强、redo/undo 管理优化、持久化模型改进以及多核利用提升。

问：8.0 的 JSON 能做到什么？
答：支持 JSON_EXTRACT、JSON_ARRAYAGG 等强表达力操作，提升半结构化存储能力。

问：DDL 原子化有什么意义？
答：避免 DDL 执行中断后表元数据损坏，提升可靠性和恢复能力。

问：MySQL 8.0 在高可用方面做了哪些加强？
答：原生 InnoDB Cluster，自动故障切换、组复制更稳定。

## 4）示意图（ASCII）

```
MySQL 5.x vs 8.0（核心能力对比）

性能体系
5.x：旧优化器、旧字典、查询缓存
8.0：优化器重写、无查询缓存、IO/锁优化

功能体系
5.x：基础 SQL 功能
8.0：窗口函数 / CTE / JSON 增强 / 隐藏索引 / 降序索引

可靠性
5.x：非原子化 DDL，元数据碎片化
8.0：事务性 DDL + crash-safe 数据字典

字符集
5.x：utf8（不完整）
8.0：utf8mb4（默认）

高可用
5.x：主从复制为主
8.0：InnoDB Cluster 原生 HA
```
