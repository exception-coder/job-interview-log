## 1）10 行极简速记版（小红书爆款风）

✔ 事务 = 多步骤操作的“要么全成，要么全灭”
🔥 ACID 是事务的灵魂四件套：A/C/I/D 缺一不可
📌 原子性保底，一旦失败直接全局回滚
🚀 一致性确保状态前后都合法，数据永不乱套
🧠 隔离性撑起并发正确性，避免事务之间互相踩踏
✨ 持久性保证提交后数据永不丢（即使宕机）
📈 事务串联多操作，但对外必须像“单操作”一样稳
🔍 转账案例 = 事务机制最经典演示
⚠️ 未提交的数据被读到？那是脏读
➤ 异常读（脏读/不可重复读/幻读）都与隔离性强弱相关

## 2）折叠式知识卡片版

<details>
<summary>定义</summary>

数据库事务是一组对数据库的操作序列，这些操作要么全部执行要么全部撤销，是保证数据正确性与一致性的最小逻辑单元。事务必须满足 **ACID** 四大特性。

</details>

<details>
<summary>原理</summary>

* **原子性**：通过 UndoLog 等机制保证任一步骤失败时可回滚至事务前状态。
* **一致性**：事务执行前后数据需保持完整性约束，如金额守恒等业务规则。
* **隔离性**：通过锁/MVCC/etc 隔离并发事务，避免读到对方未提交或中间态。
* **持久性**：RedoLog / WAL 保证提交后数据即使崩溃也能恢复。

</details>

<details>
<summary>关键点</summary>

* ACID 是关系型数据库事务设计的基础。
* 隔离性不足会导致三类异常：脏读、不可重复读、幻读。
* 一致性是业务层与数据库层共同保证的结果。
* 原子性与持久性依赖日志，隔离性依赖并发控制机制。

</details>

<details>
<summary>扩展知识</summary>

文档未直接说明但可补充：

* 不同数据库通过不同方式实现 ACID，如 MySQL InnoDB 通过 Undo/Redo/MVCC。
* 实现隔离性的常见方式：行锁、间隙锁、MVCC、多版本链。
* 隔离级别定义了数据库对异常读的容忍度。

</details>

## 3）面试官追问（Q&A）

问：事务为什么需要 UndoLog？
答：用于回滚事务，保证原子性；没有 UndoLog 无法恢复到事务开始前的状态。

问：一致性是谁来保证的？
答：数据库提供部分约束（外键、唯一性等），业务逻辑也需要共同维护。

问：为什么需要隔离性？
答：避免并发事务相互影响，如读到未提交数据、被别人更新影响查询结果。

问：隔离性与性能的关系？
答：隔离越强锁越重，吞吐越低；隔离越弱并发越高但异常读可能出现。

问：持久性如何实现？
答：依赖 RedoLog 或 WAL 机制，通过先写日志保证提交后可恢复。

问：脏读、不可重复读、幻读属于 ACID 的哪个维度？
答：隔离性不足导致的读异常。

问：事务能否跨多个 SQL？
答：可以，事务是逻辑单元，与 SQL 数量无关。

问：如果事务中途宕机会怎样？
答：未提交的部分通过 Undo 回滚，已提交的通过 Redo 恢复。

## 4）示意图（ASCII）

```
ACID 四大特性示意图

事务
 ├── 原子性（A）→ 故障即回滚（Undo Log）
 ├── 一致性（C）→ 前后一致，满足约束
 ├── 隔离性（I）→ 并发隔离，避免互相影响
 └── 持久性（D）→ 提交后永久保存（Redo Log）

异常读（隔离性相关）
 ├── 脏读
 ├── 不可重复读
 └── 幻读
```
